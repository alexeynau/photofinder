# Требования к приложению PhotoFinder

## Общая идея
- Пользователь указывает:
  - Путь к папке-источнику с фотографиями (`sourceDir`).
  - Текстовое сообщение, содержащее потенциальные номера фотографий.
  - Путь к папке-назначению, куда нужно скопировать/переместить найденные файлы (`targetDir`).
- Программа извлекает из текста номера вида `IMG_1234.ext` и ищет соответствующие файлы в указанной папке источника.
  - Префикс (`IMG` по умолчанию) должен быть настраиваемым для более гибких сценариев.
- По окончании работы отображается отчёт:
  - Список успешно обработанных файлов.
  - Список номеров, для которых файл не найден (важно для ручной проверки ложных срабатываний).

## Формат фотографий
- Имена файлов имеют вид `IMG_####.ext`, где `####` — четырёхзначный номер (включая ведущие нули), `ext` — любое расширение (обычно `.JPG`, `.PNG` и т.п.).
- Необходима поддержка потенциально разных расширений в папке источнике.

## Извлечение номеров из текста
- В тексте могут встречаться:
  - Числа через запятую, пробел, точку с запятой и другие разделители.
  - Лишняя описательная информация, которую нужно игнорировать.
  - Номера в трёхзначном формате (например, `123` вместо `0123`) — их нужно дополнить ведущим нулём до четырёх символов.
  - Представления в виде `IMG1234`, `IMG-1234`, `IMG_1234` — стоит предусмотреть общую нормализацию.
- В тексте также могут появляться посторонние числа:
  - Даты (`13.10.2025`, `2025-10-13`).
  - Телефоны (`8 920 123-45-67`, `+7 (920) 123-45-67`) — важно не выделять часть номера телефона как валидный четырёхзначный номер.
  - Произвольные числа, не относящиеся к фото.
- Предусмотреть два режима парсинга:
  - **Глупый парсер** — выделяет все трёх- и четырёхзначные числа, дополняет лидирующий ноль и используется для предпросмотра/подсветки.
  - **Умный парсер** — исключает даты, телефоны, «№ договора», «год» и т.п.; применяется при запуске обработки, если включён пользователем.
- Нужен надёжный механизм фильтрации для умного режима (например, регулярные выражения + дополнительные проверки контекста).
- Подсветка в поле ввода должна показывать найденные номера; переключение режима парсера обязано обновлять подсветку на лету.

## Обработка файлов
- Для каждого найденного номера:
  - Формируется имя `IMG_####` + доступное расширение.
  - Если файл найден — копируется или перемещается в целевую папку (режим следует сделать настраиваемым).
  - Если несколько файлов с разными расширениями имеют одинаковый номер, нужно определиться со стратегией (либо копировать все, либо первый найденный).
- Файлы, отсутствующие в исходной папке, попадают в отчёт «не найдено».
- Если папка назначения не указана, приложение создаёт подпапку `Выбор` внутри исходной директории автоматически.

## Интерфейс и платформа
- Требуется компилируемое приложение с GUI для Windows (желательно кроссплатформенное).
- Допустимые варианты:
  - Современный Windows UI (WinUI/WPF).
  - Кроссплатформенный фреймворк (Qt, Avalonia, Flutter, Electron и т.п.).
- Интерфейс должен позволять:
  - Выбрать папку-источник.
  - Вставить/загрузить текстовое сообщение с номерами.
  - Выбрать папку-назначение.
  - Запустить процесс, увидеть ход/итог (прогресс бар не обязателен, но приветствуется).
  - Просмотреть отчёт о не найденных файлах.
- Разметка должна быть компактной (без необходимости вертикальной прокрутки), список найденных номеров отображается в отчёте, а не в отдельном списке под текстом.

## Отчёт и логирование
- В конце обработки:
  - Показать количество найденных и перенесённых файлов.
  - Вывести список номеров, для которых файл не найден.
- Желательно сохранять лог в файл (например, `photofinder.log`) для дальнейшей проверки.

## Ошибки и краевые случаи
- Отсутствие доступа к папкам или невозможность создать файл в целевой папке — корректно сообщать пользователю.
- Пустой текст или отсутствие валидных номеров — отображать предупреждение.
- При необходимости выполнять нормализацию регистра расширений (учитывать `.jpg`, `.JPG` и т.д.).
- Учесть производительность при большом количестве файлов (использовать кеширование списка исходной папки).

## Дополнительные идеи для UX
- Возможность выбора режима: копирование или перемещение.
- Предпросмотр списка файлов перед перемещением.
- Поддержка Drag & Drop для папок и текста.
- Опция автоматического открытия целевой папки после завершения обработки.

## Тестовые артефакты
- Требуется подготовить примеры:
  - Папка с пустыми файлами-заглушками (`IMG_0001.jpg`, `IMG_0001.raw`, `IMG_0123.jpg`, и т.д.).
  - Набор текстовых сообщений с «грязными» наборами номеров, включая смешанные форматы и шумовые данные (даты, телефоны).
